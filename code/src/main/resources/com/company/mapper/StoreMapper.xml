<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.company.mapper.StoreMapper">

	<resultMap id="storeResultMap" type="com.company.domain.StoreDTO">
	    <id property="id" column="id"/>
	    <result property="storeName" column="store_name"/>
	    <result property="storeLocation" column="store_location"/>
	    <result property="storeDescription" column="store_description"/>
	    <result property="storeCategory" column="store_category"/>
	    <result property="phoneNumber" column="phone_number"/>
	    <result property="storeImage" column="store_image"/>
	</resultMap>

    <!-- 가게 정보 등록 -->
    <insert id="registerStore" parameterType="com.company.domain.StoreDTO">
        INSERT INTO store_registration 
        (store_name, store_location, store_description, store_category, phone_number, store_image)
        VALUES (#{storeName}, #{storeLocation}, #{storeDescription}, #{storeCategory}, #{phoneNumber}, #{storeImage});
    </insert>

    <!-- 모든 가게 조회 -->
    <select id="getAllStores" resultMap="storeResultMap">
	    SELECT *
	    FROM store_registration
	    ORDER BY id DESC;
	</select>
    
    
	<!-- 특정 가게 조회 -->
    <select id="getStoreById" parameterType="long" resultMap="storeResultMap">
        SELECT * FROM store_registration WHERE id = #{id}
    </select>
    
    <!-- ✅ 전체 가게 조회 (페이징 지원) -->
    <select id="getListWithPaging" resultMap="storeResultMap">
        SELECT *
        FROM store_registration
        ORDER BY id DESC
        LIMIT #{cri.amount} OFFSET #{cri.offset}
    </select>
    
     <!-- ✅ 전체 가게 수 조회 (페이징 계산을 위해 필요) -->
    <select id="getTotalCount" resultType="int">
        SELECT COUNT(*)
        FROM store_registration
    </select>

</mapper>
